#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
select(CountryName, SurveyYear, TFR=Value, DataId, SurveyId)
head(APIdata,20)
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line() +
geom_point() +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
setwd("C:/Users/User/Downloads")
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
select(CountryName, SurveyYear, TFR=Value, DataId, SurveyId)
head(APIdata,20)
pdf( file='DHS-API-example.pdf')
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line() +
geom_point() +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
dev.off()
sapply(APIdata,class)
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(TFR)) %>%
select(CountryName, SurveyYear, TFR=Value, DataId, SurveyId)
head(APIdata,20)
pdf( file='DHS-API-example.pdf')
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line() +
geom_point() +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
dev.off()
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(TFR)) %>%
select(CountryName, SurveyYear, TFR=Value, DataId, SurveyId)
head(APIdata,20)
sapply(APIdata,class)
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(TFR)) %>%
select(CountryName, SurveyYear, TFR=Value, DataId, SurveyId)
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(Value)) %>%
select(CountryName, SurveyYear, TFR, DataId, SurveyId)
head(APIdata,20)
pdf( file='DHS-API-example.pdf')
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line() +
geom_point() +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
dev.off()
source('C:/Users/User/Downloads/DHS-API-example.R', echo=TRUE)
windows(record=TRUE)
ggplot( data=APIdata, aes(x=SurveyYear, y=TFR, group=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
ggplot( data=APIdata, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
ggplot( data=APIdata, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title='All DHS Countries',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()  +
theme(legend.position = 'bottom')
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(Value)) %>%
select(CountryName, SurveyYear, TFR, DataId, SurveyId)
head(APIdata,20)
pdf( file='DHS-API-example.pdf', height=8.5, width=11)
print(
ggplot( data=APIdata, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title='All DHS Countries: Kind of a Mess',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
dev.off()
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(Value)) %>%
select(CountryName, SurveyYear, TFR, DataId, SurveyId)
head(APIdata,20)
pdf( file='DHS-API-example.pdf', height=8.5, width=11)
print(
ggplot( data=APIdata, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title='All DHS Countries: Kind of a Mess',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line(lwd=2, color='royalblue') +
geom_point(size=4,color='royalblue') +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
dev.off()
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(Value)) %>%
select(CountryName, SurveyYear, TFR, DataId, SurveyId)
head(APIdata,20)
pdf( file='DHS-API-example.pdf', height=8.5, width=11)
print(
ggplot( data=APIdata, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title='All DHS Countries: Kind of a Mess',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
SelectedLatAm = filter( APIdata,
CountryName %in%
c('Bolivia','Brazil','Colombia',
'Dominican Republic','Guatemala',
'Haiti','Nicaragua','Peru'))
print(
ggplot( data=SelectedLatAm, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title='DHS TFR for selected Latin American & Caribb countries',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line(lwd=2, color='royalblue') +
geom_point(size=4,color='royalblue') +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
dev.off()
print(
ggplot( data=SelectedLatAm, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,SelectedLatAm$TFR)) +
labs(title='DHS TFR for selected Latin American & Caribb countries',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(Value)) %>%
select(CountryName, SurveyYear, TFR, DataId, SurveyId)
head(APIdata,20)
pdf( file='DHS-API-example.pdf', height=8.5, width=11)
print(
ggplot( data=APIdata, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title='All DHS Countries: Kind of a Mess',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
SelectedLatAm = filter( APIdata,
CountryName %in%
c('Bolivia','Brazil','Colombia',
'Dominican Republic','Guatemala',
'Haiti','Nicaragua','Peru'))
print(
ggplot( data=SelectedLatAm, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line(lwd=2) +
geom_point(size=4) +
lims(x=range(APIdata$SurveyYear),
y=range(1,SelectedLatAm$TFR)) +
labs(title='DHS TFR for selected Latin American & Caribb countries',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line(lwd=2, color='royalblue') +
geom_point(size=4,color='royalblue') +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
dev.off()
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(Value)) %>%
select(CountryName, SurveyYear, TFR, DataId, SurveyId)
head(APIdata,20)
pdf( file='DHS-API-example.pdf', height=8.5, width=11)
print(
ggplot( data=APIdata, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title='All DHS Countries: Kind of a Mess',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
SelectedLatAm = filter( APIdata,
CountryName %in%
c('Bolivia','Brazil','Colombia',
'Dominican Republic','Guatemala',
'Nicaragua','Peru'))
print(
ggplot( data=SelectedLatAm, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line(lwd=2) +
geom_point(size=4) +
lims(x=range(APIdata$SurveyYear),
y=range(1,SelectedLatAm$TFR)) +
labs(title='DHS TFR for selected Latin American & Caribb countries',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line(lwd=2, color='royalblue') +
geom_point(size=4,color='royalblue') +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
dev.off()
setwd("~/GitHub/bonecave/DHS-API")
####################################################
# This is a variant of the R example
# from DHS website
# https://api.dhsprogram.com/#/samples-r.cfm
#
# TFR estimates for all DHS surveys
####################################################
require(RJSONIO)
library(tidyverse)
# Import DHS Indicator data for TFR for each survey
json_file <- fromJSON("https://api.dhsprogram.com/rest/dhs/data/FE_FRTR_W_TFR?perpage=500")
# Unlist the JSON file entries
json_data <- lapply(json_file$Data, function(x) { unlist(x) })
# Convert JSON input to a data frame
APIdata <- as.data.frame(do.call("rbind", json_data),
stringsAsFactors=FALSE) %>%
mutate(SurveyYear = as.numeric(SurveyYear), TFR=as.numeric(Value)) %>%
select(CountryName, SurveyYear, TFR, DataId, SurveyId)
head(APIdata,20)
#=============================================
#  make a PDF file with plots of this data
#=============================================
pdf( file='DHS-API-example.pdf', height=8.5, width=11)
print(
ggplot( data=APIdata, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line() +
geom_point() +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title='All DHS Countries: Kind of a Mess',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
SelectedLatAm = filter( APIdata,
CountryName %in%
c('Bolivia','Brazil','Colombia',
'Dominican Republic','Guatemala',
'Nicaragua','Peru'))
print(
ggplot( data=SelectedLatAm, aes(x=SurveyYear, y=TFR, group=CountryName, color=CountryName)) +
geom_line(lwd=2) +
geom_point(size=4) +
lims(x=range(APIdata$SurveyYear),
y=range(1,SelectedLatAm$TFR)) +
labs(title='DHS TFR for selected Latin American & Caribb countries',
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
for (this_country in unique(APIdata$CountryName)) {
df = filter(APIdata, CountryName==this_country)
print(
ggplot( data=df, aes(x=SurveyYear, y=TFR)) +
geom_line(lwd=2, color='royalblue') +
geom_point(size=4,color='royalblue') +
lims(x=range(APIdata$SurveyYear),
y=range(1,APIdata$TFR)) +
labs(title=this_country,
caption='Source: API at https://api.dhsprogram.com') +
theme_bw()
)
}
dev.off()
